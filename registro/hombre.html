<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario Hombre</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/styles_socio.css">
    <style>
        .required::after {
            content: " *";
            color: red;
        }
    </style>
    <script>
        function cargarAnios() {
            const anioActual = new Date().getFullYear();
            const selectAnios = document.getElementById('anios');

            const opcionSeleccion = document.createElement('option');
            opcionSeleccion.value = "";
            opcionSeleccion.textContent = "Seleccione una opción";
            selectAnios.appendChild(opcionSeleccion);

            for (let anio = 2000; anio <= anioActual; anio++) {
                const opcion = document.createElement('option');
                opcion.value = anio;
                opcion.textContent = anio;
                selectAnios.appendChild(opcion);
            }
        }

        function limpiarFormulario() {
            document.getElementById('formulario-socio').reset();
        }

        function validarFormulario(event) {
            const nombrePattern = /^[A-Za-z]+$/;
            const numeroPattern = /^[0-9]+$/;

            const primerNombre = document.getElementById('primerNombreH').value;
            const segundoNombre = document.getElementById('segundoNombreH').value;
            const tercerNombre = document.getElementById('tercerNombreH').value;
            const primerApellido = document.getElementById('primerApellidoH').value;
            const segundoApellido = document.getElementById('segundoApellidoH').value;
            const tercerApellido = document.getElementById('tercerApellidoH').value;
            const departamento = document.getElementById('departamento').value;
            const municipio = document.getElementById('municipio').value;
            const direccion = document.getElementById('direccionH').value;
            const telefono = document.getElementById('telefonoH').value;
            const dpi = document.getElementById('dpiH').value;
            const hombroCarga = document.getElementById('hombroCarga').value;
            const anioIngreso = document.getElementById('anios').value;
            const edad = document.getElementById('edadH').value;
            const fechaNacimiento = document.getElementById('fechaNacimiento').value;

            if (!nombrePattern.test(primerNombre)) {
                alert('Caracteres inválidos en Primer Nombre');
                event.preventDefault();
                return false;
            }
            if (!nombrePattern.test(segundoNombre)) {
                alert('Caracteres inválidos en Segundo Nombre');
                event.preventDefault();
                return false;
            }
            if (tercerNombre && !nombrePattern.test(tercerNombre)) {
                alert('Caracteres inválidos en Tercer Nombre');
                event.preventDefault();
                return false;
            }
            if (!nombrePattern.test(primerApellido)) {
                alert('Caracteres inválidos en Primer Apellido');
                event.preventDefault();
                return false;
            }
            if (segundoApellido && !nombrePattern.test(segundoApellido)) {
                alert('Caracteres inválidos en Segundo Apellido');
                event.preventDefault();
                return false;
            }
            if (tercerApellido && !nombrePattern.test(tercerApellido)) {
                alert('Caracteres inválidos en Tercer Apellido');
                event.preventDefault();
                return false;
            }
            if (!numeroPattern.test(telefono)) {
                alert('Caracteres inválidos en Teléfono');
                event.preventDefault();
                return false;
            }
            if (document.getElementById('dpiH').style.display !== 'none' && !numeroPattern.test(dpi)) {
                alert('Caracteres inválidos en DPI');
                event.preventDefault();
                return false;
            }
            if (hombroCarga === "") {
                alert('Por favor, seleccione una opción válida para Hombro que Carga');
                event.preventDefault();
                return false;
            }
            if (anioIngreso === "") {
                alert('Por favor, seleccione una opción válida para Año de ingreso');
                event.preventDefault();
                return false;
            }
            if (!numeroPattern.test(edad) || edad.length !== 2) {
                alert('Edad inválida. Debe ser un número de 2 dígitos.');
                event.preventDefault();
                return false;
            }

            return true;
        }

        function mostrarCampoDPI() {
            const dpiSelect = document.getElementById('dpiHSelect');
            const dpiInput = document.getElementById('dpiH');
            if (dpiSelect.value === 'ingresar') {
                dpiInput.style.display = 'block';
            } else {
                dpiInput.style.display = 'none';
            }
        }

        function cargarMunicipios() {
            const departamentos = {
                "Guatemala": ["Guatemala", "Santa Catarina Pinula", "San José Pinula", "San José del Golfo", "Palencia", "Chinautla", "San Pedro Ayampuc", "Mixco", "San Pedro Sacatepéquez", "San Juan Sacatepéquez", "San Raymundo", "Chuarrancho", "Fraijanes", "Amatitlán", "Villa Nueva", "Villa Canales", "Petapa"],
                "El Progreso": ["Guastatoya", "Morazán", "San Agustín Acasaguastlán", "San Cristóbal Acasaguastlán", "El Jícaro", "Sansare", "Sanarate", "San Antonio La Paz"],
                // Añadir los demás departamentos y municipios aquí
            };

            const departamentoSelect = document.getElementById('departamento');
            const municipioSelect = document.getElementById('municipio');
            const selectedDepartamento = departamentoSelect.value;

            municipioSelect.innerHTML = '<option value="">Seleccione un municipio</option>';

            if (selectedDepartamento) {
                const municipios = departamentos[selectedDepartamento];
                municipios.forEach(municipio => {
                    const option = document.createElement('option');
                    option.value = municipio;
                    option.textContent = municipio;
                    municipioSelect.appendChild(option);
                });
            }
        }

        function calcularEdad() {
            const fechaNacimiento = document.getElementById('fechaNacimiento').value;
            const [dia, mes, anio] = fechaNacimiento.split('/');
            const fechaNac = new Date(anio, mes - 1, dia);
            const hoy = new Date();
            let edad = hoy.getFullYear() - fechaNac.getFullYear();
            const mesDiferencia = hoy.getMonth() - fechaNac.getMonth();
            if (mesDiferencia < 0 || (mesDiferencia === 0 && hoy.getDate() < fechaNac.getDate())) {
                edad--;
            }
            document.getElementById('edadH').value = edad;

            const dpiSelect = document.getElementById('dpiHSelect');
            if (edad >= 18) {
                dpiSelect.innerHTML = '<option value="ingresar">Ingresar DPI</option>';
                document.getElementById('dpiH').style.display = 'block';
            } else {
                dpiSelect.innerHTML = '<option value="niño">Niño</option><option value="ingresar">Ingresar DPI</option>';
                document.getElementById('dpiH').style.display = 'none';
            }
        }

        function mostrarTercerApellido() {
            const generoSelect = document.getElementById('genero');
            const tercerApellidoLabel = document.getElementById('tercerApellidoLabel');
            const tercerApellidoInput = document.getElementById('tercerApellidoH');
            if (generoSelect.value === 'femenino') {
                tercerApellidoLabel.style.display = 'block';
                tercerApellidoInput.style.display = 'block';
            } else {
                tercerApellidoLabel.style.display = 'none';
                tercerApellidoInput.style.display = 'none';
            }
        }

        window.onload = function() {
            cargarAnios();
            document.getElementById('dpiHSelect').addEventListener('change', mostrarCampoDPI);
            document.getElementById('departamento').addEventListener('change', cargarMunicipios);
            document.getElementById('fechaNacimiento').addEventListener('change', calcularEdad);
            document.getElementById('genero').addEventListener('change', mostrarTercerApellido);
            inactivityTime();
        };

        function inactivityTime() {
            let time;
            window.onload = resetTimer;
            document.onmousemove = resetTimer;
            document.onkeypress = resetTimer;

            function logout() {
                alert('Sesión cerrada por inactividad');
                window.location.href = '../index.html'; // Redirige a la página inicial
            }

            function resetTimer() {
                clearTimeout(time);
                time = setTimeout(logout, 600000); // 10 minutos en milisegundos
            }
        }
    </script>
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col-md-8 offset-md-2">
                <h2>Formulario Socio Devoto</h2>
                <p style="color: red;">Campo obligatorio *</p>
                <form id="formulario-socio" onsubmit="return validarFormulario(event)">
                    <label for="genero" class="required">Género:</label>
                    <select id="genero" required>
                        <option value="">Seleccione una opción</option>
                        <option value="masculino">Masculino</option>
                        <option value="femenino">Femenino</option>
                    </select><br>

                    <label for="primerNombreH" class="required">Primer Nombre:</label>
                    <input type="text" id="primerNombreH" maxlength="15" required><br>

                    <label for="segundoNombreH" class="required">Segundo Nombre:</label>
                    <input type="text" id="segundoNombreH" maxlength="15" required><br>

                    <label for="tercerNombreH">Tercer Nombre:</label>
                    <input type="text" id="tercerNombreH" maxlength="15"><br>

                    <label for="primerApellidoH" class="required">Primer Apellido:</label>
                    <input type="text" id="primerApellidoH" maxlength="15" required><br>

                    <label for="segundoApellidoH">Segundo Apellido:</label>
                    <input type="text" id="segundoApellidoH" maxlength="15"><br>

                    <label for="tercerApellidoH" id="tercerApellidoLabel" style="display: none;">Tercer Apellido:</label>
                    <input type="text" id="tercerApellidoH" maxlength="15" style="display: none;"><br>

                    <label for="departamento" class="required">Departamento:</label>
                    <select id="departamento" required>
                        <option value="">Seleccione una opción</option>
                        <option value="Guatemala">Guatemala</option>
                        <option value="El Progreso">El Progreso</option>
                        <!-- Añadir los demás departamentos aquí -->
                    </select><br>

                    <label for="municipio" class="required">Municipio:</label>
                    <select id="municipio" required>
                        <option value="">Seleccione un municipio</option>
                    </select><br>

                    <label for="direccionH" class="required">Dirección:</label>
                    <input type="text" id="direccionH" required><br>

                    <label for="telefonoH" class="required">Teléfono:</label>
                    <input type="tel" id="telefonoH" maxlength="8" pattern="[0-9]{8}" required><br>

                    <label for="fechaNacimiento" class="required">Fecha de Nacimiento:</label>
                    <input type="text" id="fechaNacimiento" placeholder="DD/MM/AAAA" required><br>

                    <label for="edadH" class="required">Edad:</label>
                    <input type="text" id="edadH" maxlength="2" pattern="[0-9]{2}" readonly required><br>

                    <label for="alturaH" class="required">Altura Hombro:</label>
                    <input type="text" id="alturaH" maxlength="4" pattern="1\.[0-9]{2}" required><br>

                    <label for="hombroCarga" class="required">Hombro que Carga:</label>
                    <select id="hombroCarga" required>
                        <option value="">Seleccione una opción</option>
                        <option value="izquierdo">Izquierdo</option>
                        <option value="derecho">Derecho</option>
                    </select><br>

                    <label for="anios" class="required">Año de ingreso:</label>
                    <select id="anios" required></select><br>

                    <label for="fotoH">Subir Fotografía:</label>
                    <input type="file" id="fotoH" accept="image/*" capture="camera"><br>

                    <button type="submit">Enviar</button>
                </form>
                <button onclick="window.location.href='../menu/menu_opciones.html'">Regresar</button>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
